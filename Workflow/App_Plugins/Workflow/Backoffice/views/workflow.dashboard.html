<div class="umb-panel workflow" ng-controller="Workflow.Dashboard.Controller as vm">
    <form class="umb-dashboard" novalidate="">
        <umb-editor-view footer="false" umb-tabs>
            <umb-editor-container>
                <div>
                    <wf-tasks heading="'Tasks requiring my approval'" items="vm.tasks" loaded="vm.loaded[0]"></wf-tasks>
                    <wf-tasks heading="'My submissions'" items="vm.submissions" loaded="vm.loaded[1]"></wf-tasks>
                    <wf-tasks ng-if="vm.adminUser" heading="'Workflow administration'" items="vm.activeTasks" edit-link="'false'" loaded="vm.loaded[2]"></wf-tasks>

                    <script type="text/ng-template" id="wf-tasks-template.html">
                        <h3 ng-bind="heading"></h3>
                        <div ng-show="items.length">                      

                            <div class="umb-table">
                                <div class="umb-table-head">
                                    <div class="umb-table-row">
                                        <div class="umb-table-cell">
                                            <input class="umb-table__input" type="checkbox"
                                                   ng-click="selectAll($event)"
                                                   ng-checked="isSelectedAll()">
                                        </div>
                                        <div class="umb-table-cell">
                                            <a class="umb-table-head__link" href="#" prevent-default>
                                                Type
                                            </a>
                                        </div>
                                        <div class="umb-table-cell">
                                            <a class="umb-table-head__link" href="#" prevent-default>
                                                Page
                                            </a>
                                        </div>
                                        <div class="umb-table-cell">
                                            <a class="umb-table-head__link" href="#" prevent-default>
                                                Requested by
                                            </a>
                                        </div>
                                        <div class="umb-table-cell">
                                            <a class="umb-table-head__link" href="#" prevent-default>
                                                Requested on
                                            </a>
                                        </div>
                                        <div class="umb-table-cell">
                                            <a class="umb-table-head__link" href="#" prevent-default>
                                                Comments
                                            </a>
                                        </div>
                                        <div class="umb-table-cell">
                                            <a class="umb-table-head__link" href="#" prevent-default>
                                                Approver
                                            </a>
                                        </div>
                                        <div class="umb-table-cell">
                                            <a class="umb-table-head__link" href="#" prevent-default>
                                                Actions
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="umb-table-body">
                                    <div class="table-row-outer" ng-repeat="item in items track by $index">
                                        <div class="umb-table-row">

                                            <div class="umb-table-cell">
                                                <i class="umb-table-body__icon icon-document"></i>
                                            </div>
                                            <div class="umb-table-cell" ng-bind="item.Type"></div>
                                            <div class="umb-table-cell">
                                                <a href="#" ng-href="/umbraco/dialogs/preview.aspx?id={{item.NodeId}}" ng-bind="item.NodeName" target="_blank"></a>
                                            </div>
                                            <div class="umb-table-cell" ng-bind="item.RequestedBy"></div>
                                            <div class="umb-table-cell" ng-bind="item.RequestedOn"></div>
                                            <div class="umb-table-cell" ng-bind="item.Comments"></div>
                                            <div class="umb-table-cell" ng-bind="item.ApprovalGroup"></div>
                                            <div class="umb-table-cell">
                                                <a ng-if="editLink != 'false'" ng-href="/umbraco#/content/content/edit/{{item.NodeId}}" class="icon icon-edit action-Edit" title="Edit"></a>
                                                <button ng-if="item.IsPublished === true" ng-click="showDifferences(item)" class="icon icon-trafic" title="Show differences"></button>
                                                <button ng-if="item.ShowActionLink === true" ng-click="approveTask(item)" class="icon icon-check" title="Action workflow"></button>
                                                <button ng-click="cancelTask(item)" class="icon icon-delete" title="Cancel workflow"></button>
                                            </div>
                                        </div>
                                        <div class="workflow-progress">
                                            <div class="progress-step" ng-class="{ 'done' : item.CurrentStep > p.Permission, 'current' : item.CurrentStep === p.Permission }" style="width: calc(100% / {{ item.Permissions.length }})" ng-repeat="p in item.Permissions track by $index | orderBy: 'Permission'">
                                                <span class="marker"></span>
                                                <span class="tooltip">
                                                    <span class="tooltip-done">Approved:</span>
                                                    <span class="tooltip-current">Pending:</span>
                                                    {{ p.UserGroup.Name }}
                                                </span>                                                
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex justify-center">
                                <wf-paging-controls></wf-paging-controls>
                            </div>
                        </div>

                        <umb-empty-state ng-if="!items.length">
                            <localize key="content_listViewNoItems">There are no items show in the list.</localize>
                        </umb-empty-state>
                    </script>
                </div>
            </umb-editor-container>
        </umb-editor-view>
    </form>
</div>